"use strict";define(["./render.js","jquery","jqcookie","lazyload"],function(e,r){return{init:function(){this.louti(),this.isLogin(),this.logout(),this.search(),this.searchGood(),this.showChat(),this.rightSidebar(),this.weChat(),this.loginBox(),e.index_render()},louti:function(){r("#main section").on("click",function(e){if("A"==e.target.nodeName){var t=r("#main section").eq(r(e.target).parent().index()).offset().top;r("html,body").animate({scrollTop:t},500)}})},isLogin:function(){var t=this;if(+r.cookie("flag")){var e=/^1[3,4,5,7,8]\d{9}$/.test(r.cookie("username"))?"phone":"email";r.ajax({type:"post",data:e+"="+r.cookie("username")+"&password="+r.cookie("password"),url:"../php/check_login.php"}).done(function(e){e?(r.cookie("flag",1,{expires:7,path:"/"}),t.changeHead()):r.cookie("flag",0,{expires:7,path:"/"})})}else r.cookie("flag",0,{expires:7,path:"/"}),t.changeHead()},changeHead:function(){+r.cookie("flag")?(r(".login").html("<a href='login.html'>欢迎您,"+r.cookie("username")+"</a>&nbsp;&nbsp;&nbsp;&nbsp;\n                <a href='javascript:;'>我的梦芭莎</a>"),r(".register").html("<a href=\"javascript:;\" class='logout'>退出</a>")):(r(".login").html('<a href="login.html" class="loginaddress">登录</a>'),r(".register").html('<a href="register.html">注册</a>'))},logout:function(){r("header ul").on("click",function(e){r(e.target).is(".logout")&&(r.cookie("username","",{expires:-1,path:"/"}),r.cookie("password","",{expires:-1,path:"/"}),r.cookie("flag","0",{expires:7,path:"/"}),location.reload())})},search:function(){r(".search_value").on("input",function(){r.ajax({url:"https://suggest.taobao.com/sug?code=utf-8&q="+r(".search_value").val()+"&_ksTS=1569402939975_317&callback=taobao&k=1&area=c2c&bucketid=15",dataType:"jsonp"}).done(function(e){var t="",o=!0,i=!1,a=void 0;try{for(var n,s=e.result[Symbol.iterator]();!(o=(n=s.next()).done);o=!0){t+="\n                            <aside>"+n.value[0]+"</aside>\n                        "}}catch(e){i=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}r(".search .result").html(t)})})},searchGood:function(){r(".result").on("click",function(e){"ASIDE"===e.target.nodeName&&(r(".search_value").val(r(e.target).html()),r(".search .result").html(""),r(document).on("blur",function(){r(".search .result").html("")}))})},showChat:function(){r(".chat").hover(function(){r(this).children("img").show()},function(){r(this).children("img").hide()})},stairsShow:function(){1e3<=r("html,body").scrollTop()?r(".stairs").show():r(".stairs").hide()},rightSidebar:function(){var e=this;this.stairsShow(),r(document).on("scroll",function(){e.stairsShow()})},weChat:function(){r(".wechat").hover(function(){r(".wechat img").show()},function(){r(".wechat img").hide()})},loginBox:function(){+r.cookie("flag")&&r(".login_box").html('\n                    <img class="img2" src="http://i0.mbscss.com/img/moonbasa2/member/default-head.jpg" alt="">\n                    <p class="username">用户名:'+r.cookie("username")+'</p>\n                    <p class="usertype">会员类型:普通客户</p>\n                '),r("#user").hover(function(){r(".login_box").show()},function(){r(".login_box").hide()}),r.cookie("num")&&r(".shopcount").html(r.cookie("num").split(",").map(function(e){return+e}).reduce(function(e,t){return e+t})),r("#left_sidebar").on("mouseover",function(e){r(e.target).parents("section").is(".cartList")||r(e.target).is(".sideBar")||r(e.target).is(".sideBar p")?r(".cartList").show():r(".cartList").hide()}),r(".cartList").on("mouseout",function(){r(".cartList").hide()})}}});