"use strict";define(["./render.js","./index_effect.js","jquery","jqcookie"],function(i,e,r){return{small_pic:r("#small_pic"),small_box:r("#small_box"),smallf:document.querySelector("#smallf"),bigf:r(".bigf"),big_pic:r("#big_pic"),list:r("article .list"),init:function(){r("#list").load("session.html"),r("#footer").load("index_footer.html"),r.cookie("url",location.href,{expires:7,path:"/"}),i.details_render(),this.fdj(),this.clickChange(),this.chooseGood(),this.chooseSize(),this.changeNum(),this.slideGood(),this.addCart(),e.changeHead(),e.logout()},fdj:function(){var l=this,i=this.small_pic.width()*this.bigf.width()/this.big_pic.width(),e=this.small_pic.height()*this.bigf.height()/this.big_pic.height();this.smallf.style.width=i+"px",this.smallf.style.height=e+"px";var s=this.big_pic.width()/this.small_pic.width();this.small_box.hover(function(){l.bigf.show(),r(l.smallf).show(),r(document).on("mousemove",function(i){var e=i.pageX-r(l.smallf).width()/2-r(l.small_pic).offset().left,t=i.pageY-r(l.smallf).height()/2-r(l.small_pic).offset().top;e<=0?e=0:e>=l.small_pic.width()-l.smallf.offsetWidth&&(e=l.small_pic.width()-l.smallf.offsetWidth),t<=0?t=0:t>=l.small_pic.height()-l.smallf.offsetHeight&&(t=l.small_pic.height()-l.smallf.offsetHeight),l.smallf.style.left=e+"px",l.smallf.style.top=t+"px",l.big_pic.get(0).style.left=-e*s+"px",l.big_pic.get(0).style.top=-t*s+"px"}),r(document).off("mouseover",function(){l.small_box.off(),r(document).off()})},function(){l.bigf.hide(),r(l.smallf).hide()})},clickChange:function(){var e=this;this.list.on("mouseover",function(i){"IMG"===i.target.nodeName&&(e.small_pic.attr("src",i.target.src.replace("small","large").replace("S.jpg","L.jpg")),r(".list img").removeClass("active"),r(i.target).addClass("active"))})},chooseGood:function(){r("aside .choose").on("click",function(i){"IMG"===i.target.nodeName||"SPAN"===i.target.nodeName?(r("aside .choose div").removeClass("active"),r(i.target).parent().addClass("active")):r(i.target).is(".color_content")&&(r("aside .choose div").removeClass("active"),r(i.target).addClass("active"))})},chooseSize:function(){r(".size").on("click",function(i){"SPAN"===i.target.nodeName&&(r(".size span").removeClass("active"),r(i.target).addClass("active"))})},changeNum:function(){r(".num .up").on("click",function(){r(".num input").val(+r(".num input").val()+1)}),r(".num .down").on("click",function(){1==r(".num input").val()?r(".num input").val(1):r(".num input").val(+r(".num input").val()-1)})},slideGood:function(){var e=0;r(".slon").on("click",function(){var i=r(".list ul li").innerHeight();e=0==e?0:--e,r(".list ul").get(0).style.left=-e*i+"px",console.log(e)}),r(".sron").on("click",function(){var i=r(".list ul li").innerHeight();e=6<r(".list ul li").length?e==r(".list ul li").length-7?r(".list ul li").length-7:++e:0,r(".list ul").get(0).style.left=-e*i+"px"})},addCart:function(){r(".addCart").on("click",function(){if(r.cookie("sid")){var i=function(){r.cookie("sid",t,{expires:7,path:"/"}),r.cookie("color",l,{expires:7,path:"/"}),r.cookie("size",s,{expires:7,path:"/"}),r.cookie("num",o,{expires:7,path:"/"}),alert("添加成功")},e=function(){t.push(location.search.replace("?sid=","")),l.push(r(".color .active span").html()),s.push(r(".size .active").html()),o.push(r(".num input").val())},t=r.cookie("sid").split(","),l=r.cookie("color").split(","),s=r.cookie("size").split(","),o=r.cookie("num").split(","),a=!1,c=!1,n=!1,h=null;r.each(t,function(i,e){if(e==location.search.replace("?sid=","")&&(l[i]==r(".color .active span").html()&&(a=!0),s[i]==r(".size .active").html()&&(c=!0),l[i]==r(".color .active span").html()&&s[i]==r(".size .active").html()))return h=i,c=a=!(n=!0)}),-1!=t.indexOf(location.search.replace("?sid=",""))?a?(e(),i()):c?(e(),i()):n?(o[h]=Number(o[h])+Number(r(".num input").val()),r.cookie("num",o,{expires:7,path:"/"}),alert("添加成功")):(e(),i()):(e(),i())}else r.cookie("sid",location.search.replace("?sid=",""),{expires:7,path:"/"}),r.cookie("color",r(".color .active span").html(),{expires:7,path:"/"}),r.cookie("size",r(".size .active").html(),{expires:7,path:"/"}),r.cookie("num",r(".num input").val(),{expires:7,path:"/"}),alert("添加成功")})}}});