"use strict";define("render.js",["jquery"],function(){return{index_render:function(){var i=this;$.ajax({url:"../php/data.php",dataType:"json"}).done(function(e){i.chooseRender(e,"文艺女装",$("#main .literature"),0),i.chooseRender(e,"优雅女装",$("#main .grace"),1),i.chooseRender(e,"活泼女装",$("#main .lively"),2),i.chooseRender(e,"简约女装",$("#main .simplicity"),3),i.chooseRender(e,"度假女装",$("#main .vacation"),4),i.chooseRender(e,"舒适内衣",$("#main .underwear"),5),i.chooseRender(e,"品质男装",$("#main .mens"),6),i.chooseRender(e,"箱包品类",$("#main .package"),7),i.indexCart(e),$(function(){$("img.lazy").lazyload({effect:"fadeIn"})})})},chooseRender:function(e,i,t,n){var o="<ul>";$.each(["文艺女装","优雅女装","活泼女装","简约女装","度假女装","舒适内衣","品质男装","箱包品类"],function(e,i){o+=n==e?"<li><a href=\"javascript:void(0);\" class='active'>"+i+"</a></li>":'<li><a href="javascript:void(0);">'+i+"</a></li>"}),o+="</ul>";var a=!0,s=!1,l=void 0;try{for(var c,r=e[Symbol.iterator]();!(a=(c=r.next()).done);a=!0){var h=c.value;h.type===i&&(o+='\n                    <div class="good">\n                    <a href="details.html?sid='+h.sid+'" target=\'_blank\'>\n                        <img class="lazy"\n                            data-original="'+h.small_url+'"\n                            width="225" height="304">\n                    </a>\n                    <div>\n                        <a href="">￥'+h.new_price+'</a>\n                        <a href="">￥'+h.old_price+"</a>\n                    </div>\n                </div>")}}catch(e){s=!0,l=e}finally{try{!a&&r.return&&r.return()}finally{if(s)throw l}}t.html(o)},details_render:function(){var e=location.search.replace("?","");$.ajax({url:"../php/check_good.php?"+e,dataType:"json"}).done(function(e){var t,i,n,o,a,s,l,c;$("#store").html(e.store),$("#small_pic").attr({src:e.small_url}),$("title").html(e.title),$("#big_pic").attr({src:e.small_url.replace("large","huge").replace("L.jpg","H.jpg")}),$("#detail main article .list ul").html((t="",i=e.urls.split(","),$.each(i,function(e,i){t+=0===e?'\n                            <li><img src="'+i+'S.jpg" alt="" class=\'active\'></li>\n                            ':'\n                        <li><img src="'+i+'S.jpg" alt=""></li>\n                        '}),t)),$("#detail h2").html(e.title),$("#detail .new_price").html("￥"+e.new_price),$("#detail .old_price").html("￥"+e.old_price),$("#detail .choose").html((o="",a=(n=e).color.split(","),s=n.urls_good.split(","),$.each(a,function(e,i){o+=0===e?'\n                            <div class="color_content active">\n                                <img src="'+s[e]+'" alt="">\n                                <span>'+i+"</span>\n                            </div>\n                        ":'\n                        <div class="color_content">\n                            <img src="'+s[e]+'" alt="">\n                        <span>'+i+"</span>\n                        </div>\n                        "}),o)),$("#detail .size div").html((l="",c=e.size.split(","),$.each(c,function(e,i){l+=0===e?"\n                            <span class='active'>"+i+"</span>\n                        ":"\n                            <span>"+i+"</span>\n                        "}),l)),$(function(){$("img.lazy").lazyload({effect:"fadeIn"})})})},cart_render:function(e,i,t){if($.cookie("sid")){var n=Array.from(new Set($.cookie("sid").split(","))).map(function(e){return+e}).sort(function(e,i){return e-i}),s=$.cookie("sid").split(","),l=$.cookie("color").split(","),c=$.cookie("size").split(","),r=$.cookie("num").split(",");$.ajax({url:"../php/cart.php?sid="+n,type:"get",dataType:"json"}).done(function(a){$.each(n,function(t,n){var o='\n                        <aside>\n                        <div class="title">\n                            <p>以下商品由 <span>'+a[t].store+"</span> 发货 免配送费</p>\n                        </div>\n                        ";$.each(s,function(e,i){n==i&&(a[t].new_price*r[t],o+='\n                                <div class="shop_content">\n                                    <input type="checkbox" class="choose">\n                                    <div class="good_info">\n                                        <img src="'+a[t].small_url+'" alt="">\n                                        <p>'+a[t].title+"</p>\n                                        <div>\n                                            <p>品牌:"+a[t].store+"</p>\n                                            <p class='cSize'>尺寸:"+c[e]+"</p>\n                                            <p class='cColor'>颜色:"+l[e]+'</p>\n                                        </div>\n                                    </div>\n                                    <p class="single_price">￥'+a[t].new_price+'</p>\n                                    <div class="number">\n                                        <button class="del">-</button>\n                                        <input type="text" class="good_num" value="'+r[e]+'">\n                                        <button class="add">+</button>\n                                    </div>\n                                    <p class="total_price">￥'+a[t].new_price*r[e]+'</p>\n                                    <div class="opecation">\n                                        <button class="remove">移除</button>\n                                    </div>\n                                </div>\n                            ')}),o+="</aside>",$(".good_content").html($(".good_content").html()+o);$.each(r,function(e,i){+i}),$(".deal").html('\n                        <div>\n                            <p>商品数量总计: <span class="sum"></span>\n                            <span>件 折后商品金额总计</span>\n                            <span id="total_price">￥</span>\n                            </p>\n                        </div>\n                        <div>\n                            <button class=\'settle\'>去结算</button>\n                        </div>\n                        ')}),i(),t(),e()})}else $(".deal").html("\n                    <p class='empty'>您的购物车空空如也,快去挑选一些商品吧</p>\n                    <a href='index.html'>去首页</a>\n                ")},indexCart:function(o){if($.cookie("sid")){var e=Array.from(new Set($.cookie("sid").split(","))).map(function(e){return+e}).sort(function(e,i){return e-i}),i=$.cookie("sid").split(","),a=$.cookie("color").split(","),s=$.cookie("size").split(","),l=$.cookie("num").split(","),c="",r=0;$.each(e,function(t,n){c+='\n                        <div class="good_content">\n                        <p class="store">'+o[t].title+"</p>\n                    ",$.each(i,function(e,i){n==i&&(r+=l[e]*o[t].new_price,c+='\n                                <div class="shop_content">\n                                <div class="onegood">\n                                    <img src="'+o[t].small_url+'" alt="">\n                                    <div class="info">\n                                        <p class="shoptitle">'+o[t].title+'</p>\n                                        <div class="colorinfo">\n                                            <span>'+s[e]+"</span>\n                                            <span>"+a[e]+'</span>\n                                        </div>\n                                        <div class="priceinfo">\n                                            <span class="goodprice">￥'+o[t].new_price+'</span>\n                                            <span class="goodnum">*'+l[e]+"</span>\n                                        </div>\n                                    </div>\n                                </div>\n                        ")}),c+="</div>"}),$(".indexCart").html(c),$(".counting").html('\n                <div>\n                <span class="goodNum">共'+l.map(function(e){return+e}).reduce(function(e,i){return e+i})+'件商品</span>\n                <span class="goodPrice">￥'+r+'</span>\n                </div>\n                <a href="cart.html" class="totalPrice">去购物车结算</a>\n                ')}else $(".indexCart").html(""),$(".counting").html("")}}}),define("index_effect.js",["./render.js","jquery","jqcookie","lazyload"],function(e,l){return{init:function(){l("#list").load("session.html"),l("#footer").load("index_footer.html"),this.louti(),this.isLogin(),this.logout(),this.search(),this.searchGood(),this.showChat(),this.rightSidebar(),this.weChat(),this.loginBox(),e.index_render()},louti:function(){l("#main section").on("click",function(e){if("A"==e.target.nodeName){var i=l("#main section").eq(l(e.target).parent().index()).offset().top;l("html,body").animate({scrollTop:i},500)}})},isLogin:function(){var i=this;if(+l.cookie("flag")){var e=/^1[3,4,5,7,8]\d{9}$/.test(l.cookie("username"))?"phone":"email";l.ajax({type:"post",data:e+"="+l.cookie("username")+"&password="+l.cookie("password"),url:"../php/check_login.php"}).done(function(e){e?(l.cookie("flag",1,{expires:7,path:"/"}),i.changeHead()):l.cookie("flag",0,{expires:7,path:"/"})})}else l.cookie("flag",0,{expires:7,path:"/"}),i.changeHead()},changeHead:function(){+l.cookie("flag")?(l(".login").html("<a href='login.html'>欢迎您,"+l.cookie("username")+"</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href='javascript:;'>我的梦芭莎</a>"),l(".register").html("<a href=\"javascript:;\" class='logout'>退出</a>")):(l(".login").html('<a href="login.html" class="loginaddress">登录</a>'),l(".register").html('<a href="register.html">注册</a>'))},logout:function(){l("header ul").on("click",function(e){l(e.target).is(".logout")&&(l.cookie("username","",{expires:-1,path:"/"}),l.cookie("password","",{expires:-1,path:"/"}),l.cookie("flag","0",{expires:7,path:"/"}),location.reload())})},search:function(){l(".search_value").on("input",function(){l.ajax({url:"https://suggest.taobao.com/sug?code=utf-8&q="+l(".search_value").val()+"&_ksTS=1569402939975_317&callback=taobao&k=1&area=c2c&bucketid=15",dataType:"jsonp"}).done(function(e){var i="",t=!0,n=!1,o=void 0;try{for(var a,s=e.result[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){i+="\n                            <aside>"+a.value[0]+"</aside>\n                        "}}catch(e){n=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw o}}l(".search .result").html(i)})})},searchGood:function(){l(".result").on("click",function(e){"ASIDE"===e.target.nodeName&&(l(".search_value").val(l(e.target).html()),l(".search .result").html(""),l(document).on("blur",function(){l(".search .result").html("")}))})},showChat:function(){l(".chat").hover(function(){l(this).children("img").show()},function(){l(this).children("img").hide()})},stairsShow:function(){1e3<=l("html,body").scrollTop()?l(".stairs").show():l(".stairs").hide()},rightSidebar:function(){var e=this;this.stairsShow(),l(document).on("scroll",function(){e.stairsShow()})},weChat:function(){l(".wechat").hover(function(){l(".wechat img").show()},function(){l(".wechat img").hide()})},loginBox:function(){+l.cookie("flag")&&l(".login_box").html('\n                    <img class="img2" src="http://i0.mbscss.com/img/moonbasa2/member/default-head.jpg" alt="">\n                    <p class="username">用户名:'+l.cookie("username")+'</p>\n                    <p class="usertype">会员类型:普通客户</p>\n                '),l("#user").hover(function(){l(".login_box").show()},function(){l(".login_box").hide()}),l.cookie("num")&&l(".shopcount").html(l.cookie("num").split(",").map(function(e){return+e}).reduce(function(e,i){return e+i})),l("#left_sidebar").on("mouseover",function(e){l(e.target).parents("section").is(".cartList")||l(e.target).is(".sideBar")||l(e.target).is(".sideBar p")?l(".cartList").show():l(".cartList").hide()}),l(".cartList").on("mouseout",function(){l(".cartList").hide()})}}}),define("details_effect",["./render.js","./index_effect.js","jquery","jqcookie"],function(e,i,h){return{small_pic:h("#small_pic"),small_box:h("#small_box"),smallf:document.querySelector("#smallf"),bigf:h(".bigf"),big_pic:h("#big_pic"),list:h("article .list"),init:function(){h("#list").load("session.html"),h("#footer").load("index_footer.html"),h.cookie("url",location.href,{expires:7,path:"/"}),e.details_render(),this.fdj(),this.clickChange(),this.chooseGood(),this.chooseSize(),this.changeNum(),this.slideGood(),this.addCart(),i.changeHead(),i.logout()},fdj:function(){var n=this,e=this.small_pic.width()*this.bigf.width()/this.big_pic.width(),i=this.small_pic.height()*this.bigf.height()/this.big_pic.height();this.smallf.style.width=e+"px",this.smallf.style.height=i+"px";var o=this.big_pic.width()/this.small_pic.width();this.small_box.hover(function(){n.bigf.show(),h(n.smallf).show(),h(document).on("mousemove",function(e){var i=e.pageX-h(n.smallf).width()/2-h(n.small_pic).offset().left,t=e.pageY-h(n.smallf).height()/2-h(n.small_pic).offset().top;i<=0?i=0:i>=n.small_pic.width()-n.smallf.offsetWidth&&(i=n.small_pic.width()-n.smallf.offsetWidth),t<=0?t=0:t>=n.small_pic.height()-n.smallf.offsetHeight&&(t=n.small_pic.height()-n.smallf.offsetHeight),n.smallf.style.left=i+"px",n.smallf.style.top=t+"px",n.big_pic.get(0).style.left=-i*o+"px",n.big_pic.get(0).style.top=-t*o+"px"}),h(document).off("mouseover",function(){n.small_box.off(),h(document).off()})},function(){n.bigf.hide(),h(n.smallf).hide()})},clickChange:function(){var i=this;this.list.on("mouseover",function(e){"IMG"===e.target.nodeName&&(i.small_pic.attr("src",e.target.src.replace("small","large").replace("S.jpg","L.jpg")),h(".list img").removeClass("active"),h(e.target).addClass("active"),i.big_pic.attr("src",e.target.src.replace("small","huge").replace("S.jpg","H.jpg")))})},chooseGood:function(){h("aside .choose").on("click",function(e){"IMG"===e.target.nodeName||"SPAN"===e.target.nodeName?(h("aside .choose div").removeClass("active"),h(e.target).parent().addClass("active")):h(e.target).is(".color_content")&&(h("aside .choose div").removeClass("active"),h(e.target).addClass("active"))})},chooseSize:function(){h(".size").on("click",function(e){"SPAN"===e.target.nodeName&&(h(".size span").removeClass("active"),h(e.target).addClass("active"))})},changeNum:function(){h(".num .up").on("click",function(){h(".num input").val(+h(".num input").val()+1)}),h(".num .down").on("click",function(){1==h(".num input").val()?h(".num input").val(1):h(".num input").val(+h(".num input").val()-1)})},slideGood:function(){var i=0;h(".slon").on("click",function(){var e=h(".list ul li").innerHeight();i=0==i?0:--i,h(".list ul").get(0).style.left=-i*e+"px",console.log(i)}),h(".sron").on("click",function(){var e=h(".list ul li").innerHeight();i=6<h(".list ul li").length?i==h(".list ul li").length-7?h(".list ul li").length-7:++i:0,h(".list ul").get(0).style.left=-i*e+"px"})},addCart:function(){h(".addCart").on("click",function(){if(h.cookie("sid")){var e=function(){h.cookie("sid",t,{expires:7,path:"/"}),h.cookie("color",n,{expires:7,path:"/"}),h.cookie("size",o,{expires:7,path:"/"}),h.cookie("num",a,{expires:7,path:"/"}),alert("添加成功")},i=function(){t.push(location.search.replace("?sid=","")),n.push(h(".color .active span").html()),o.push(h(".size .active").html()),a.push(h(".num input").val())},t=h.cookie("sid").split(","),n=h.cookie("color").split(","),o=h.cookie("size").split(","),a=h.cookie("num").split(","),s=!1,l=!1,c=!1,r=null;h.each(t,function(e,i){if(i==location.search.replace("?sid=","")&&(n[e]==h(".color .active span").html()&&(s=!0),o[e]==h(".size .active").html()&&(l=!0),n[e]==h(".color .active span").html()&&o[e]==h(".size .active").html()))return r=e,l=s=!(c=!0)}),-1!=t.indexOf(location.search.replace("?sid=",""))?s?(i(),e()):l?(i(),e()):c?(a[r]=Number(a[r])+Number(h(".num input").val()),h.cookie("num",a,{expires:7,path:"/"}),alert("添加成功")):(i(),e()):(i(),e())}else h.cookie("sid",location.search.replace("?sid=",""),{expires:7,path:"/"}),h.cookie("color",h(".color .active span").html(),{expires:7,path:"/"}),h.cookie("size",h(".size .active").html(),{expires:7,path:"/"}),h.cookie("num",h(".num input").val(),{expires:7,path:"/"}),alert("添加成功")})}}});